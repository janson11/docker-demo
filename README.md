# docker-demo
docker demo

## 1 Docker的原理
Docker 是利用 Linux 的 Namespace 、Cgroups 和联合文件系统三大机制来保证实现的， 所以它的原理是使用 Namespace 做主机名、网络、PID 等资源的隔离，使用 Cgroups 对进程或者进程组做资源（例如：CPU、内存等）的限制，联合文件系统用于镜像构建和容器运行环境。
* Namespace:
    Docker 主要用到以下五种命名空间。
    pid namespace：用于隔离进程 ID。
    net namespace：隔离网络接口，在虚拟的 net namespace 内用户可以拥有自己独立的 IP、路由、端口等。
    mnt namespace：文件系统挂载点隔离。
    ipc namespace：信号量,消息队列和共享内存的隔离。
    uts namespace：主机名和域名的隔离。
* Cgroups
  Cgroups 是一种 Linux 内核功能，可以限制和隔离进程的资源使用情况（CPU、内存、磁盘 I/O、网络等）。在容器的实现中，Cgroups 通常用来限制容器的 CPU 和内存等资源的使用。
* 联合文件系统
  联合文件系统，又叫 UnionFS，是一种通过创建文件层进程操作的文件系统，因此，联合文件系统非常轻快。Docker 使用联合文件系统为容器提供构建层，使得容器可以实现写时复制以及镜像的分层构建和存储。常用的联合文件系统有 AUFS、Overlay 和 Devicemapper 等。

## 2 Docker核心概念
* 镜像：
  它是一个只读的文件和文件夹组合。它包含了容器运行时所需要的所有基础文件和配置信息，是容器启动的基础。所以你想启动一个容器，那首先必须要有一个镜像。镜像是 Docker 容器启动的先决条件。
  镜像的使用方式：
  1、自己创建镜像。通常情况下，一个镜像是基于一个基础镜像构建的，你可以在基础镜像上添加一些用户自定义的内容。
  2、从功能镜像仓库拉取别人制作好的镜像。
  
* 容器：
  容器是 Docker 的另一个核心概念。通俗地讲，容器是镜像的运行实体。镜像是静态的只读文件，而容器带有运行时需要的可写文件层，并且容器中的进程属于运行状态。即容器运行着真正的应用进程。容器有初建、运行、停止、暂停和删除五种状态。
  虽然容器的本质是主机上运行的一个进程，但是容器有自己独立的命名空间隔离和资源限制。也就是说，在容器内部，无法看到主机上的进程、环境变量、网络等信息，这是容器与直接运行在主机上进程的本质区别。

* 仓库：
 Docker 的镜像仓库类似于代码仓库，用来存储和分发 Docker 镜像。镜像仓库分为公共镜像仓库和私有镜像仓库。
 
目前主要有两个标准文档：容器运行时标准 （runtime spec）和容器镜像标准（image spec）。

## 3 Docker命令
 启动命令：
 docker run -d busybox sleep 3600
 通过以下命令查看一下 dockerd 的 PID：
 ps aux |grep dockerd
 进程父子关系
  sudo pstree -l -a -A 4147

